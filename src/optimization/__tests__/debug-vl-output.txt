=== PROJECT STRUCTURE ===
WorldPoints: 6
Viewpoints: 2
  C3: 6 image points, 9 vanishing lines
  C1: 6 image points, 0 vanishing lines

=== OPTIMIZATION ===

=== RESULT ===
Converged: true
Iterations: 39
Residual: 1.3044547552163186
Median reproj: 0.36321192476719294
Cameras initialized: C3, C1
Cameras excluded: none

=== OPTIMIZATION LOGS ===
[Optimize] WP:6 L:7 VP:2 IP:12 C:0
[validateVanishingPoints] Added 7 virtual VP lines from direction-constrained Lines
[VP] WARNING: VP very far from origin (u=552, v=-117925)
[Init Debug] uninitCameras=2, lockedPts=2, canVP=true
[validateVanishingPoints] Added 7 virtual VP lines from direction-constrained Lines
[Init Path] skipVPForLatePnP=false (uninit=2, locked=2, hasVL=true)
[validateVanishingPoints] Added 7 virtual VP lines from direction-constrained Lines
[initializeCameraWithVanishingPoints] Starting vanishing point initialization...
[validateVanishingPoints] Added 7 virtual VP lines from direction-constrained Lines
[VP Init] Vanishing points:
  X: (-4301.349, 428.552)
  Y: (552.367, -117924.631)
  Z: (1350.160, 427.696)
[initializeCameraWithVanishingPoints] Using existing principal point: (551.5, 397.0)
[initializeCameraWithVanishingPoints] Using existing focal length: 2014.0
[VP Debug] X VP at (-4301, 429) -> direction LEFT/DOWN in camera [-0.924, -0.006, 0.383]
[VP Debug] Y VP at (552, -117925) -> direction RIGHT/UP in camera [0.000, 1.000, 0.017]
[VP Debug] Z VP at (1350, 428) -> direction RIGHT/DOWN in camera [0.369, -0.014, 0.929]
[VP Debug] All 3 VPs observed. Initial directions:
[VP Debug]   d_x = [-0.9236, -0.0060, 0.3833]
[VP Debug]   d_y = [0.0000, 0.9999, 0.0170]
[VP Debug]   d_z = [0.3686, -0.0142, 0.9295]
[VP Debug] X × Y = [-0.3833, 0.0157, -0.9235]
[VP Debug] (X × Y) · Z = -0.9999 (LEFT-HANDED)
[VP Debug] Flipping d_z to make base rotation RIGHT-HANDED
[VP Debug] Cross product check: X × Y dot Z = -1.000 (should be +1 for right-handed, -1 for left-handed)
[VP Debug] WARNING: VP configuration appears LEFT-HANDED! The Z VP is on the opposite side of X×Y.
[VP Debug] Orthogonality check: X·Y=0.001, X·Z=-0.016, Y·Z=-0.002 (all should be ~0)
[VP Debug] Rotation determinant (base): 0.999872 (should be +1 for right-handed)
[VP Debug] Computed rotation matrix from vanishing points (base):
[ -0.923605, 0.000007, -0.368599 ]
[ -0.006005, 0.999855, 0.014167 ]
[ 0.383299, 0.017019, -0.929481 ]
[VP Debug] Quaternion (base): [-0.19153,-0.001528,0.981453,0.007944]
[VP Debug] Added alternate rotation with flipped Y and X (base)
[VP Debug] Returning 2 base rotation(s)
[initializeCameraWithVanishingPoints] Trying 2 base rotation(s)
[VP RH] Z-axis point WP2: z=+10 err=Infinitypx, z=-10 err=Infinitypx -> NEGATIVE Z
[VP RH] X-axis point WP4: x=+10 err=Infinitypx, x=-10 err=Infinitypx -> NEGATIVE X
[VP RH] optimalX=-, optimalZ=- -> RIGHT-HANDED (+bonus)
[VP Sign Debug] NEW BEST: [Y=Z×X false,false,false] score=280000.0, avgError=10000.0px
[VP RH] Z-axis point WP2: z=+10 err=230.5px, z=-10 err=1.9px -> NEGATIVE Z
[VP RH] X-axis point WP4: x=+10 err=621.0px, x=-10 err=0.9px -> NEGATIVE X
[VP RH] optimalX=-, optimalZ=- -> RIGHT-HANDED (+bonus)
[VP Sign Debug] NEW BEST: [Y=Z×X true,true,false] score=2299999.1, avgError=0.4px
[VP RH] Z-axis point WP2: z=+10 err=Infinitypx, z=-10 err=Infinitypx -> NEGATIVE Z
[VP RH] X-axis point WP4: x=+10 err=Infinitypx, x=-10 err=Infinitypx -> NEGATIVE X
[VP RH] optimalX=-, optimalZ=- -> RIGHT-HANDED (+bonus)
[VP RH] Z-axis point WP2: z=+10 err=1.9px, z=-10 err=230.5px -> POSITIVE Z
[VP RH] X-axis point WP4: x=+10 err=0.9px, x=-10 err=621.0px -> POSITIVE X
[VP RH] optimalX=+, optimalZ=+ -> RIGHT-HANDED (+bonus)
[VP RH] Z-axis point WP2: z=+10 err=230.5px, z=-10 err=1.9px -> NEGATIVE Z
[VP RH] X-axis point WP4: x=+10 err=621.0px, x=-10 err=0.9px -> NEGATIVE X
[VP RH] optimalX=-, optimalZ=- -> RIGHT-HANDED (+bonus)
[VP RH] Z-axis point WP2: z=+10 err=Infinitypx, z=-10 err=Infinitypx -> NEGATIVE Z
[VP RH] X-axis point WP4: x=+10 err=Infinitypx, x=-10 err=Infinitypx -> NEGATIVE X
[VP RH] optimalX=-, optimalZ=- -> RIGHT-HANDED (+bonus)
[VP RH] Z-axis point WP2: z=+10 err=1.9px, z=-10 err=230.5px -> POSITIVE Z
[VP RH] X-axis point WP4: x=+10 err=0.9px, x=-10 err=621.0px -> POSITIVE X
[VP RH] optimalX=+, optimalZ=+ -> RIGHT-HANDED (+bonus)
[VP RH] Z-axis point WP2: z=+10 err=Infinitypx, z=-10 err=Infinitypx -> NEGATIVE Z
[VP RH] X-axis point WP4: x=+10 err=Infinitypx, x=-10 err=Infinitypx -> NEGATIVE X
[VP RH] optimalX=-, optimalZ=- -> RIGHT-HANDED (+bonus)
[initializeCameraWithVanishingPoints] Camera predicted vanishing points:
  X axis -> VP at (-4412.67, 429.37)
  Y axis -> VP at (556.98, -124072.38)
  Z axis -> VP at (1368.77, 429.62)
[initializeCameraWithVanishingPoints] Success! Position: [20.25, -7.49, 58.50], Rotation: [-0.008, 0.981, 0.002, -0.192]
[Init] C3 via VP, f=2014
[Init Path] skipVPForLatePnP=false (uninit=2, locked=2, hasVL=false)
[validateVanishingPoints] Added 7 virtual VP lines from direction-constrained Lines
[initializeCameraWithVanishingPoints] Starting vanishing point initialization...
[validateVanishingPoints] Added 7 virtual VP lines from direction-constrained Lines
[VP Init] Vanishing points:
  X: (-1715.024, -299.352)
  Y: (558.824, 6118.716)
  Z: (2620.564, -393.994)
[initializeCameraWithVanishingPoints] Using existing principal point: (553.5, 396.5)
[VP Focal] X-Y pair: f=1998.5
[VP Focal] X-Z pair: f=2034.5
[VP Focal] Y-Z pair: f=2124.2
[initializeCameraWithVanishingPoints] Estimated focal length from VPs: 2034.5 (was 1107)
[VP Debug] X VP at (-1715, -299) -> direction LEFT/UP in camera [-0.726, 0.223, 0.651]
[VP Debug] Y VP at (559, 6119) -> direction RIGHT/DOWN in camera [0.001, -0.942, 0.335]
[VP Debug] Z VP at (2621, -394) -> direction RIGHT/UP in camera [0.688, 0.263, 0.677]
[VP Debug] All 3 VPs observed. Initial directions:
[VP Debug]   d_x = [-0.7258, 0.2226, 0.6509]
[VP Debug]   d_y = [0.0009, -0.9422, 0.3350]
[VP Debug]   d_z = [0.6876, 0.2630, 0.6768]
[VP Debug] X × Y = [0.6879, 0.2437, 0.6837]
[VP Debug] (X × Y) · Z = 0.9998 (RIGHT-HANDED)
[VP Debug] Cross product check: X × Y dot Z = 1.000 (should be +1 for right-handed, -1 for left-handed)
[VP Debug] Orthogonality check: X·Y=0.008, X·Z=-0.000, Y·Z=-0.020 (all should be ~0)
[VP Debug] Rotation determinant (base): 0.999762 (should be +1 for right-handed)
[VP Debug] Computed rotation matrix from vanishing points (base):
[ -0.725783, 0.000877, 0.687619 ]
[ 0.222628, -0.942219, 0.262962 ]
[ 0.650904, 0.334997, 0.676780 ]
[VP Debug] Quaternion (base): [0.06061,0.365849,0.163436,0.914205]
[VP Debug] Added alternate rotation with flipped Y and X (base)
[VP Debug] Returning 2 base rotation(s)
[initializeCameraWithVanishingPoints] Trying 2 base rotation(s)
[VP RH] Z-axis point WP2: z=+10 err=3.9px, z=-10 err=333.3px -> POSITIVE Z
[VP RH] X-axis point WP4: x=+10 err=3.9px, x=-10 err=360.7px -> POSITIVE X
[VP RH] optimalX=+, optimalZ=+ -> RIGHT-HANDED (+bonus)
[VP Sign Debug] NEW BEST: [Y=Z×X false,false,false] score=2299997.9, avgError=1.0px
[VP RH] Z-axis point WP2: z=+10 err=Infinitypx, z=-10 err=Infinitypx -> NEGATIVE Z
[VP RH] X-axis point WP4: x=+10 err=Infinitypx, x=-10 err=Infinitypx -> NEGATIVE X
[VP RH] optimalX=-, optimalZ=- -> RIGHT-HANDED (+bonus)
[VP RH] Z-axis point WP2: z=+10 err=333.3px, z=-10 err=3.9px -> NEGATIVE Z
[VP RH] X-axis point WP4: x=+10 err=360.7px, x=-10 err=3.9px -> NEGATIVE X
[VP RH] optimalX=-, optimalZ=- -> RIGHT-HANDED (+bonus)
[VP RH] Z-axis point WP2: z=+10 err=Infinitypx, z=-10 err=Infinitypx -> NEGATIVE Z
[VP RH] X-axis point WP4: x=+10 err=Infinitypx, x=-10 err=Infinitypx -> NEGATIVE X
[VP RH] optimalX=-, optimalZ=- -> RIGHT-HANDED (+bonus)
[VP RH] Z-axis point WP2: z=+10 err=Infinitypx, z=-10 err=Infinitypx -> NEGATIVE Z
[VP RH] X-axis point WP4: x=+10 err=Infinitypx, x=-10 err=Infinitypx -> NEGATIVE X
[VP RH] optimalX=-, optimalZ=- -> RIGHT-HANDED (+bonus)
[VP RH] Z-axis point WP2: z=+10 err=3.9px, z=-10 err=333.3px -> POSITIVE Z
[VP RH] X-axis point WP4: x=+10 err=3.9px, x=-10 err=360.7px -> POSITIVE X
[VP RH] optimalX=+, optimalZ=+ -> RIGHT-HANDED (+bonus)
[VP RH] Z-axis point WP2: z=+10 err=Infinitypx, z=-10 err=Infinitypx -> NEGATIVE Z
[VP RH] X-axis point WP4: x=+10 err=Infinitypx, x=-10 err=Infinitypx -> NEGATIVE X
[VP RH] optimalX=-, optimalZ=- -> RIGHT-HANDED (+bonus)
[VP RH] Z-axis point WP2: z=+10 err=333.3px, z=-10 err=3.9px -> NEGATIVE Z
[VP RH] X-axis point WP4: x=+10 err=360.7px, x=-10 err=3.9px -> NEGATIVE X
[VP RH] optimalX=-, optimalZ=- -> RIGHT-HANDED (+bonus)
[initializeCameraWithVanishingPoints] Camera predicted vanishing points:
  X axis -> VP at (-1718.73, -325.65)
  Y axis -> VP at (605.47, 5964.64)
  Z axis -> VP at (2617.49, -366.12)
[initializeCameraWithVanishingPoints] Success! Position: [-55.49, -42.77, -60.71], Rotation: [0.061, 0.366, 0.163, 0.914]
[Init] C1 via VP, f=2034
[Tri] LARGE DEPTH: t1=44, t2=105, maxDepth=14558
[Tri] 2 pts: O:[0.0,0.0,0.0] WP2:[0.0,0.0,10.0] WP4:[10.0,0.0,0.0] OY:[0.0,-10.0,0.0] WP6:[6.8,-7.8,16.9] WP7:[-13.4,-15.2,-16.2]
[Align] y-axis: dot=1.00 -> +
[Align] y-axis: chose +Y
[Scale] Applied scale=1.000 from 1 point pairs
[VP] WARNING: VP very far from origin (u=569, v=-118618)
[Solve] conv=true, iter=39, median=0.36px | C3:f=2014 C1:f=2067
[Handedness] Result is LEFT-HANDED (no locked coords to determine axis), applying Z-flip
[AxisFlips] Applying flips: X=false, Y=false, Z=true (1 total)
[AxisFlips] Odd number of flips - will set isZReflected=true
[AxisFlips] Camera C3: position and rotation transformed, isZReflected=true
[AxisFlips] Camera C1: position and rotation transformed, isZReflected=true
[Summary] ** Good | error=1.304 | median=0.36px | iter=39 | conv=true | 1224ms

=== FINAL CAMERA POSITIONS ===
C3: pos=[20.1, -7.7, -58.7] f=2014
C1: pos=[54.9, -43.4, -63.1] f=2067

=== WORLD POINT POSITIONS ===