
========================================
X-LINE TEST
========================================

X-line: direction=x, targetLength=20
X-line connects: O to WP1

--- X-LINE OPTIMIZATION LOGS ---
[Optimize] v2.4.0-single-vp-init
[Optimize] WP:8 L:1 VP:2 IP:16 C:2
[validateVanishingPoints] Added 1 virtual VP lines from direction-constrained Lines
[validateVanishingPoints] Added 1 virtual VP lines from direction-constrained Lines
[validateVanishingPoints] Added 1 virtual VP lines from direction-constrained Lines
[validateVanishingPoints] Added 1 virtual VP lines from direction-constrained Lines
[Init] Using standard initialization orchestrator
[Init Debug] uninitCameras=2, lockedPts=1 (trulyLocked=1), canVP=false (relaxed=false)
[Init Debug] No cameras initialized. uninitCameras=2, canUseLatePnP=false
[EssentialMatrix] 8 pts, t=[5.51,-4.42,7.08]
[Init] EssentialMatrix: 1=[0.0,0.0,0.0], 2=[-7.3,-3.0,6.1]
[VP+EM] Checking cameras for VP rotation...
[validateVanishingPoints] Added 1 virtual VP lines from direction-constrained Lines
[VP+EM] 1: isValid=false, vpCount=0
[validateVanishingPoints] Added 1 virtual VP lines from direction-constrained Lines
[VP+EM] 2: isValid=false, vpCount=0
[Init] Camera at origin conflicts with locked point - offsetting cameras by [0,0,-10]
[Tri] 6 pts: WP1:[20.0,0.0,0.0] WP2:[1.3,1.0,-1.0] WP3:[-0.9,0.7,-2.5] O:[0.0,0.0,0.0] WP5:[-0.6,0.5,-3.1] WP6:[-0.4,-1.1,-4.5] WP7:[1.8,0.9,-1.6] WP8:[1.3,-1.2,-3.4]
[Align] x-axis: EM single-axis (dot=1.00), testing both orientations
[Align] x-axis: quick test: +err=22.04, -err=22.04
[Align] x-axis: long test: +err=1.94, -err=1.94
[Align] x-axis: errors similar, AMBIGUOUS
[Align] x-axis: chose +X
[Scale] axisConstrainedLines=1, linesWithTargetLength=1, usedEssentialMatrix=true
[Scale] Line O-WP1: skipped (both endpoints from inference)
[WARN] Single axis constraint - one rotational DoF unresolved
[Stage1] WP positions BEFORE:
  WP1: dist=20.0, pos=[20.0, 0.0, 0.0]
  WP2: dist=1.9, pos=[1.3, -1.3, -0.5]
  WP3: dist=2.8, pos=[-0.9, -2.6, 0.5]
  O: dist=0.0, pos=[0.0, 0.0, 0.0]
  WP5: dist=3.2, pos=[-0.6, -3.0, 0.9]
  WP6: dist=4.7, pos=[-0.4, -3.6, 3.0]
  WP7: dist=2.6, pos=[1.8, -1.8, -0.1]
  WP8: dist=3.8, pos=[1.3, -2.5, 2.6]
[Stage1] Multi-cam only: WP:8 L:1 IP:16 -> conv=true, iter=186, res=22.942
[Stage1] WP positions AFTER:
[Solve] conv=true, iter=16, median=0.47px | 1:f=1474 2:f=1472
[Handedness] Cannot determine handedness (no axis points found)
[Summary] ** Good | error=2.151 | median=0.47px | iter=16 | conv=true | 7889ms

[X Line] Median error: 0.47px
[X Line] Converged: true, Iterations: 16

[X Line] Final camera poses:
  Camera 1 (1):
    Position: [-27.39, -60.10, 17.93]
    Rotation: [0.5120, 0.8064, -0.0641, 0.2888]
    Focal: 1474.0
  Camera 2 (2):
    Position: [-46.33, 6.34, -47.67]
    Rotation: [0.0333, 0.3835, -0.1644, 0.9082]
    Focal: 1472.0


========================================
Z-LINE TEST
========================================

Z-line: direction=z, targetLength=25
Z-line connects: O to WP6

--- Z-LINE OPTIMIZATION LOGS ---
[Optimize] v2.4.0-single-vp-init
[Optimize] WP:8 L:1 VP:2 IP:16 C:2
[validateVanishingPoints] Added 1 virtual VP lines from direction-constrained Lines
[validateVanishingPoints] Added 1 virtual VP lines from direction-constrained Lines
[validateVanishingPoints] Added 1 virtual VP lines from direction-constrained Lines
[validateVanishingPoints] Added 1 virtual VP lines from direction-constrained Lines
[Init] Using standard initialization orchestrator
[Init Debug] uninitCameras=2, lockedPts=1 (trulyLocked=1), canVP=false (relaxed=false)
[Init Debug] No cameras initialized. uninitCameras=2, canUseLatePnP=false
[EssentialMatrix] 8 pts, t=[5.51,-4.42,7.08]
[Init] EssentialMatrix: 1=[0.0,0.0,0.0], 2=[-7.3,-3.0,6.1]
[VP+EM] Checking cameras for VP rotation...
[validateVanishingPoints] Added 1 virtual VP lines from direction-constrained Lines
[VP+EM] 1: isValid=false, vpCount=0
[validateVanishingPoints] Added 1 virtual VP lines from direction-constrained Lines
[VP+EM] 2: isValid=false, vpCount=0
[Init] Camera at origin conflicts with locked point - offsetting cameras by [0,0,-10]
[Tri] 6 pts: WP1:[0.8,-1.2,-2.8] WP2:[1.3,1.0,-1.0] WP3:[-0.9,0.7,-2.5] O:[0.0,0.0,0.0] WP5:[-0.6,0.5,-3.1] WP6:[0.0,0.0,25.0] WP7:[1.8,0.9,-1.6] WP8:[1.3,-1.2,-3.4]
[Align] z-axis: EM single-axis (dot=1.00), testing both orientations
[Align] z-axis: quick test: +err=2.04, -err=2.04
[Align] z-axis: long test: +err=2.04, -err=2.04
[Align] z-axis: errors similar, AMBIGUOUS
[Align] z-axis: chose +Z
[Scale] axisConstrainedLines=1, linesWithTargetLength=1, usedEssentialMatrix=true
[Scale] Line O-WP6: skipped (both endpoints from inference)
[WARN] Single axis constraint - one rotational DoF unresolved
[Stage1] WP positions BEFORE:
  WP1: dist=3.1, pos=[-0.3, 1.4, -2.8]
  WP2: dist=1.9, pos=[-1.6, -0.4, -1.0]
  WP3: dist=2.8, pos=[0.5, -1.0, -2.5]
  O: dist=0.0, pos=[0.0, 0.0, 0.0]
  WP5: dist=3.2, pos=[0.4, -0.7, -3.1]
  WP6: dist=25.0, pos=[0.0, 0.0, 25.0]
  WP7: dist=2.6, pos=[-2.0, -0.1, -1.6]
  WP8: dist=3.8, pos=[-0.7, 1.6, -3.4]
[Stage1] Multi-cam only: WP:8 L:1 IP:16 -> conv=true, iter=342, res=91.419
[Stage1] WP positions AFTER:
[Retry] Ambiguous alignment with poor result (47.18 > 20), trying opposite sign
[Retry] Was positive, now trying negative
[EssentialMatrix] 8 pts, t=[5.51,-4.42,7.08]
[Tri] 6 pts: WP1:[0.8,-1.2,7.2] WP2:[1.3,1.0,9.0] WP3:[-0.9,0.7,7.5] O:[0.0,0.0,0.0] WP5:[-0.6,0.5,6.9] WP6:[0.0,0.0,25.0] WP7:[1.8,0.9,8.4] WP8:[1.3,-1.2,6.6]
[Align] z-axis: FORCED to negative
[Align] z-axis: chose -Z
[Retry] Camera 1 at locked point O - moved back
[Retry] Stage1: conv=true, iter=50, res=491.987
[Retry] negative result: conv=false, res=486.575
[Retry] negative is WORSE (486.575 >= 47.175), restoring original
[Solve] conv=true, iter=69, median=94.21px | 1:f=1474 2:f=1472
[Outliers] 8 found (threshold=283px):
  WP2@2: 242.4px
  WP6@2: 227.0px
  WP8@2: 158.9px
  WP7@2: 145.3px
  WP1@2: 133.7px
  O@2: 132.8px
  WP5@2: 130.6px
  WP3@2: 94.2px
[Handedness] Cannot determine handedness (no axis points found)
[Summary] * Poor | error=47.175 | median=94.21px | iter=69 | conv=true | 7226ms

[Z Line] Median error: 94.21px
[Z Line] Converged: true, Iterations: 69

[Z Line] Final camera poses:
  Camera 1 (1):
    Position: [-20.48, 146.22, -61.01]
    Rotation: [0.2135, -0.1239, 0.5588, -0.7917]
    Focal: 1474.0
  Camera 2 (2):
    Position: [-104.43, 172.79, 20.74]
    Rotation: [-0.3826, 0.6171, -0.4170, 0.5467]
    Focal: 1472.0

========================================
COMPARISON SUMMARY
========================================
X-line error: 0.47px (PASS)
Z-line error: 94.21px (FAIL)

Difference: 93.75px